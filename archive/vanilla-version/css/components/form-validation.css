/**
 * Form Validation Component
 * Real-time validation styling, error messages, success states
 */

/* ========== FORM FIELD STATES ========== */

.form-field {
    margin-bottom: var(--space-4, 1rem);
}

.form-label {
    display: block;
    font-size: var(--font-size-sm, 0.875rem);
    font-weight: var(--font-weight-medium, 500);
    color: var(--text-primary, #111827);
    margin-bottom: var(--space-2, 0.5rem);
}

.form-label.required::after {
    content: ' *';
    color: var(--danger, #ef4444);
}

/* ========== INPUT STATES ========== */

.form-input,
.form-textarea,
.form-select {
    width: 100%;
    padding: var(--space-3, 0.75rem) var(--space-4, 1rem);
    font-size: var(--font-size-base, 1rem);
    line-height: var(--line-height-normal, 1.5);
    color: var(--input-text, #111827);
    background: var(--input-bg, #ffffff);
    border: var(--border-width-1) solid var(--input-border, #d1d5db);
    border-radius: var(--radius-lg, 0.5rem);
    transition: all var(--transition-base, 200ms) ease;
    font-family: inherit;
}

.form-input::placeholder,
.form-textarea::placeholder {
    color: var(--input-placeholder, #9ca3af);
}

/* Focus state */
.form-input:focus,
.form-textarea:focus,
.form-select:focus {
    outline: none;
    border-color: var(--input-border-focus, #667eea);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

/* Valid state */
.form-input.is-valid,
.form-textarea.is-valid,
.form-select.is-valid {
    border-color: var(--success, #10b981);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%2310b981'%3E%3Cpath fill-rule='evenodd' d='M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z' clip-rule='evenodd'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--space-3) center;
    background-size: 20px;
    padding-right: var(--space-10, 2.5rem);
}

.form-input.is-valid:focus,
.form-textarea.is-valid:focus,
.form-select.is-valid:focus {
    border-color: var(--success, #10b981);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
}

/* Invalid state */
.form-input.is-invalid,
.form-textarea.is-invalid,
.form-select.is-invalid {
    border-color: var(--danger, #ef4444);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23ef4444'%3E%3Cpath fill-rule='evenodd' d='M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z' clip-rule='evenodd'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--space-3) center;
    background-size: 20px;
    padding-right: var(--space-10, 2.5rem);
}

.form-input.is-invalid:focus,
.form-textarea.is-invalid:focus,
.form-select.is-invalid:focus {
    border-color: var(--danger, #ef4444);
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

/* Disabled state */
.form-input:disabled,
.form-textarea:disabled,
.form-select:disabled {
    background: var(--input-disabled-bg, #f3f4f6);
    color: var(--input-disabled-text, #9ca3af);
    cursor: not-allowed;
    opacity: 0.6;
}

/* ========== VALIDATION MESSAGES ========== */

.form-feedback {
    display: none;
    font-size: var(--font-size-sm, 0.875rem);
    margin-top: var(--space-2, 0.5rem);
    line-height: var(--line-height-snug, 1.375);
}

.form-feedback.show {
    display: block;
}

/* Error message */
.form-feedback.error {
    color: var(--danger-text, #991b1b);
}

.form-feedback.error::before {
    content: '⚠ ';
    font-size: 1em;
    margin-right: var(--space-1, 0.25rem);
}

/* Success message */
.form-feedback.success {
    color: var(--success-text, #065f46);
}

.form-feedback.success::before {
    content: '✓ ';
    font-size: 1em;
    margin-right: var(--space-1, 0.25rem);
}

/* Warning message */
.form-feedback.warning {
    color: var(--warning-text, #92400e);
}

.form-feedback.warning::before {
    content: '⚡ ';
    font-size: 1em;
    margin-right: var(--space-1, 0.25rem);
}

/* Info message */
.form-feedback.info {
    color: var(--info-text, #1e40af);
}

.form-feedback.info::before {
    content: 'ℹ ';
    font-size: 1em;
    margin-right: var(--space-1, 0.25rem);
}

/* ========== FIELD HELP TEXT ========== */

.form-help {
    display: block;
    font-size: var(--font-size-xs, 0.75rem);
    color: var(--text-tertiary, #6b7280);
    margin-top: var(--space-1, 0.25rem);
}

/* ========== VALIDATION SUMMARY ========== */

.form-validation-summary {
    padding: var(--space-4, 1rem);
    border-radius: var(--radius-lg, 0.5rem);
    margin-bottom: var(--space-6, 1.5rem);
    border: 1px solid;
}

.form-validation-summary.error {
    background: var(--danger-light, #fee2e2);
    border-color: var(--danger, #ef4444);
    color: var(--danger-text, #991b1b);
}

.form-validation-summary.success {
    background: var(--success-light, #d1fae5);
    border-color: var(--success, #10b981);
    color: var(--success-text, #065f46);
}

.form-validation-summary-title {
    font-weight: var(--font-weight-semibold, 600);
    margin-bottom: var(--space-2, 0.5rem);
}

.form-validation-summary-list {
    margin: 0;
    padding-left: var(--space-5, 1.25rem);
}

.form-validation-summary-list li {
    margin-bottom: var(--space-1, 0.25rem);
}

/* ========== INLINE VALIDATION ========== */

.form-field-inline {
    display: flex;
    align-items: center;
    gap: var(--space-3, 0.75rem);
}

.form-field-inline .form-input {
    flex: 1;
}

.form-field-inline .validation-icon {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}

.validation-icon.valid {
    color: var(--success, #10b981);
}

.validation-icon.invalid {
    color: var(--danger, #ef4444);
}

/* ========== CHECKBOX & RADIO VALIDATION ========== */

.form-check {
    display: flex;
    align-items: flex-start;
    gap: var(--space-2, 0.5rem);
    margin-bottom: var(--space-3, 0.75rem);
}

.form-check-input {
    width: 18px;
    height: 18px;
    margin-top: 2px;
    cursor: pointer;
}

.form-check-input:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.form-check-input.is-invalid {
    border-color: var(--danger, #ef4444);
}

.form-check-label {
    font-size: var(--font-size-sm, 0.875rem);
    color: var(--text-primary, #111827);
    cursor: pointer;
    user-select: none;
}

/* ========== FLOATING LABELS ========== */

.form-floating {
    position: relative;
}

.form-floating .form-input,
.form-floating .form-textarea {
    padding-top: var(--space-5, 1.25rem);
    padding-bottom: var(--space-2, 0.5rem);
}

.form-floating .form-label {
    position: absolute;
    top: var(--space-3, 0.75rem);
    left: var(--space-4, 1rem);
    font-size: var(--font-size-base, 1rem);
    color: var(--text-tertiary, #6b7280);
    transition: all var(--transition-base, 200ms);
    pointer-events: none;
    transform-origin: left top;
}

.form-floating .form-input:focus ~ .form-label,
.form-floating .form-input:not(:placeholder-shown) ~ .form-label,
.form-floating .form-textarea:focus ~ .form-label,
.form-floating .form-textarea:not(:placeholder-shown) ~ .form-label {
    top: var(--space-2, 0.5rem);
    font-size: var(--font-size-xs, 0.75rem);
    color: var(--text-secondary, #374151);
}

/* ========== FIELD COUNTER ========== */

.form-field-counter {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: var(--space-1, 0.25rem);
}

.form-counter {
    font-size: var(--font-size-xs, 0.75rem);
    color: var(--text-tertiary, #6b7280);
}

.form-counter.warning {
    color: var(--warning, #f59e0b);
}

.form-counter.error {
    color: var(--danger, #ef4444);
}

/* ========== PASSWORD STRENGTH ========== */

.password-strength {
    margin-top: var(--space-2, 0.5rem);
}

.password-strength-meter {
    height: 4px;
    background: var(--surface-hover, #f3f4f6);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.password-strength-fill {
    height: 100%;
    transition: width var(--transition-base, 200ms), background-color var(--transition-base, 200ms);
    border-radius: var(--radius-full);
}

.password-strength-fill.weak {
    width: 25%;
    background: var(--danger, #ef4444);
}

.password-strength-fill.fair {
    width: 50%;
    background: var(--warning, #f59e0b);
}

.password-strength-fill.good {
    width: 75%;
    background: var(--info, #3b82f6);
}

.password-strength-fill.strong {
    width: 100%;
    background: var(--success, #10b981);
}

.password-strength-label {
    font-size: var(--font-size-xs, 0.75rem);
    margin-top: var(--space-1, 0.25rem);
}

/* ========== ACCESSIBILITY ========== */

/* Screen reader only text */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

/* Focus visible for keyboard navigation */
.form-input:focus-visible,
.form-textarea:focus-visible,
.form-select:focus-visible,
.form-check-input:focus-visible {
    outline: 2px solid var(--primary, #667eea);
    outline-offset: 2px;
}

/* ========== ANIMATIONS ========== */

@keyframes shake {
    0%, 100% {
        transform: translateX(0);
    }
    10%, 30%, 50%, 70%, 90% {
        transform: translateX(-5px);
    }
    20%, 40%, 60%, 80% {
        transform: translateX(5px);
    }
}

.form-input.shake,
.form-textarea.shake {
    animation: shake 0.5s;
}

@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.form-feedback.show {
    animation: fadeInDown var(--transition-base, 200ms) ease-out;
}

/* ========== DARK MODE ========== */

[data-theme="dark"] .form-input,
[data-theme="dark"] .form-textarea,
[data-theme="dark"] .form-select {
    background: var(--input-bg, #1e293b);
    border-color: var(--input-border, #475569);
    color: var(--input-text, #f1f5f9);
}

[data-theme="dark"] .form-input::placeholder,
[data-theme="dark"] .form-textarea::placeholder {
    color: var(--input-placeholder, #64748b);
}

[data-theme="dark"] .form-validation-summary.error {
    background: var(--danger-light, #7f1d1d);
    border-color: var(--danger, #ef4444);
    color: var(--danger-text, #fca5a5);
}

[data-theme="dark"] .form-validation-summary.success {
    background: var(--success-light, #064e3b);
    border-color: var(--success, #10b981);
    color: var(--success-text, #6ee7b7);
}

/* ========== RESPONSIVE ========== */

@media (max-width: 768px) {
    .form-input,
    .form-textarea,
    .form-select {
        font-size: 16px; /* Prevents zoom on iOS */
    }

    .form-field-inline {
        flex-direction: column;
        align-items: stretch;
    }

    .form-validation-summary {
        padding: var(--space-3, 0.75rem);
    }
}
